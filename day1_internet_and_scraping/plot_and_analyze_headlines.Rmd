---
title: "Analyzing and plotting headlines"
author: "Tom Theile"
date: "25 2 2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(plyr) 
library(dplyr)
library(tidyverse)
```


```{R}
fn ="./data/df_all_headlines_sentiments.csv"
df_headlines_sentiments = read.csv(fn)
df_headlines_sentiments$date = as.Date(df_headlines_sentiments$date)
print(head(df_headlines_sentiments))
summary(df_headlines_sentiments)
```
```{R}
df_headlines_sentiments$news_url = factor(df_headlines_sentiments$news_url)
print(levels(df_headlines_sentiments$news_url))
df_headlines_sentiments$news_name = revalue(df_headlines_sentiments$news_url,
               c("https://www.dailymail.co.uk/home/index.html"="dailymail",
                 "https://www.foxnews.com/" ="foxnews",
                 "https://www.theguardian.com" = "guardian",
                 "https://www.washingtonpost.com/" = "washingtonpost"))
```

```{R}
sources = unique(df_headlines_sentiments$news_url)
sources[1]
summary(filter(df_headlines_sentiments, news_url==sources[1]))
```

```{R}
```

```{R}
library(ggplot2)
ggplot(data = df_headlines_sentiments, mapping = aes(x = news_name, y = fear)) +
  geom_violin(alpha=0)+
  geom_jitter(alpha = 0.3, color = "tomato")
  
  geom_point(alpha = 0.1, aes(color = trust))

```


```{R}
ggplot(data = df_headlines_sentiments, mapping = aes(x = positive, y = joy, color = news_name)) +
  geom_jitter(alpha = 0.05)+
  facet_wrap(facets =  vars(news_name))+
  xlim(0,7) + ylim(0,7)
  
  geom_point(alpha = 0.1, aes(color = trust))

```
#### How many articles are in the dataset, by source?
```{R}
ggplot(df_headlines_sentiments, aes(x = news_name)) +
  geom_bar()
```
```{R}
mean_sentiments = df_headlines_sentiments %>%
  group_by(news_name) %>%
  summarise(
    meanpos = mean(positive),
    meanneg = mean(negative),
    meanjoy = mean(joy),
    meandisgust = mean(disgust),
    meananger = mean(anger),
  )
mean_sentiments


mean_sentiments_long <- mean_sentiments %>%
  pivot_longer(!news_name,names_to = "meanwhat", values_to = "mvalue")
mean_sentiments_long
```

```{R}

ggplot(data = mean_sentiments_long, mapping = aes(x = news_name, y = mvalue,color=meanwhat)) +
  geom_point()

```

### Exercise + Assignment for today:

* create new data.frames based on filters:
 * Row contains "ukraine" or "peace" or "war".... you can be creative
 * look for less common words: which source was the first to talk about swift? Or something else?
* Then plot
 * occurrences over time, colored by the news_name
 * compare the sources
* optional:
 * make an interesting wordcloud
 * fraction of occurrences of some words over time
 * use the sentiment data: did the sentiments change over time? Did fear increase? What if you filter by a word and then look at the sentiments?




```{R, echo=FALSE}

```



```{R, echo=FALSE}


```


```{R, echo=FALSE}
ggplot(df_putin, aes(x=date)) + geom_bar()

```


